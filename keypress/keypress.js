/* Keypress version 1.0.8 */
(function(){var u,v,j,P,Q,R,S,w,x,y,T,F,G,z,o,U,V,W,X,H,Y,Z,$,aa,ba,I,ca,p,q,g,J,r,da,K,s,L,A,t,M,B,h,N,C,n,D,O,E,ea,i=Array.prototype.indexOf||function(a){for(var c=0,b=this.length;c<b;c++)if(c in this&&this[c]===a)return c;return-1},fa=Object.prototype.hasOwnProperty;h=[];n=[];D=null;g=[];j=[];A=!1;K="ctrl";L="meta alt option ctrl shift cmd".split(" ");E=[];x={keys:[],count:0};z=function(a,c){var b;if(a.filter)return a.filter(c);var d,e,f;f=[];d=0;for(e=a.length;d<e;d++)b=a[d],c(b)&&f.push(b);return f};
r=function(){return console.log.apply(console,arguments)};y=function(a,c){var b,d,e;if(a.length!==c.length)return!1;d=0;for(e=a.length;d<e;d++)if(b=a[d],!(0<=i.call(c,b)))return!1;return!0};T=function(a,c){var b,d;if(a.length!==c.length)return!1;b=0;for(d=a.length;0<=d?b<d:b>d;0<=d?b++:b--)if(a[b]!==c[b])return!1;return!0};$=function(a,c){var b,d,e;d=0;for(e=a.length;d<e;d++)if(b=a[d],0>i.call(c,b))return!1;return!0};aa=function(a,c){var b,d,e,f;e=d=0;for(f=a.length;e<f;e++)if(b=a[e],b=c.indexOf(b),
b>=d)d=b;else return!1;return!0};t=function(a,c){if((c||keypress.suppress_event_defaults)&&!keypress.force_event_defaults)if(a.preventDefault?a.preventDefault():a.returnValue=!1,a.stopPropagation)return a.stopPropagation()};R=function(a){if(a.prevent_repeat)return!1;if("function"===typeof a.on_keydown)return!0};J=function(a){var c,b,d,e;e=a.keys;b=0;for(d=e.length;b<d;b++)if(a=e[b],0<=i.call(g,a)){c=!0;break}return c};o=function(a,c,b){"function"===typeof c["on_"+a]&&t(b,!1===c["on_"+a].call(c["this"],
b,c.count));"release"===a&&(c.count=0);if("keyup"===a)return c.keyup_fired=!0};da=function(a,c){var b,d,e;d=0;for(e=h.length;d<e;d++)b=h[d],(b.is_ordered&&T(a,b.keys)||!b.is_ordered&&y(a,b.keys))&&c(b)};U=function(a,c){var b,d,e;d=0;for(e=h.length;d<e;d++)b=h[d],(b.is_ordered&&aa(b.keys,a)||!b.is_ordered&&$(b.keys,a))&&c(b)};w=function(a){return 0<=i.call(g,"cmd")&&0>i.call(a,"cmd")?!1:!0};V=function(a){var c,b;c=[];b=z(g,function(b){return b!==a});b.push(a);da(b,function(b){if(w(b.keys))return c.push(b)});
U(b,function(b){if(!(0<=i.call(c,b))&&!b.is_solitary&&w(b.keys))return c.push(b)});return c};X=function(a){var c,b,d,e;b=[];d=0;for(e=h.length;d<e;d++)c=h[d],c.is_sequence||0<=i.call(c.keys,a)&&w(c.keys)&&b.push(c);return b};Q=function(a){var c,b,d,e,f,g,h,l,k,m;g=!1;f=!0;d=!1;if(0<=i.call(j,a))return!0;if(j.length){e=0;for(k=j.length;0<=k?e<k:e>k;0<=k?e++:e--)if((c=j[e])&&c.is_exclusive&&a.is_exclusive){c=c.keys;if(!g){h=0;for(l=c.length;h<l;h++)if(b=c[h],g=!0,0>i.call(a.keys,b)){g=!1;break}}if(f&&
!g){m=a.keys;h=0;for(l=m.length;h<l;h++)if(b=m[h],f=!1,0>i.call(c,b)){f=!0;break}}g&&(d?C(j.splice(e,1)):(C(j.splice(e,1,a)),d=!0),f=!1)}}f&&j.unshift(a);return g||f};N=function(a){var c,b,d;b=0;for(d=j.length;0<=d?b<d:b>d;0<=d?b++:b--)if(c=j[b],c===a){C(j.splice(b,1));break}};C=function(a){if(a)return a.count=null,a.keyup_fired=null};P=function(a,c){var b,d,e,f;n.push(a);d=W();if(d.length){e=0;for(f=d.length;e<f;e++)b=d[e],t(c,b.prevent_default);D&&clearTimeout(D);-1<keypress.sequence_delay&&(D=
setTimeout(function(){return n=[]},keypress.sequence_delay))}else n=[]};W=function(){var a,c,b,d,e,f,g,j,l,k;e=[];g=0;for(j=h.length;g<j;g++){a=h[g];b=1;for(l=n.length;1<=l?b<=l:b>=l;1<=l?b++:b--)if(f=n.slice(-b),a.is_sequence){if(0>i.call(a.keys,"shift")&&(f=z(f,function(b){return"shift"!==b}),!f.length))continue;c=0;for(k=f.length;0<=k?c<k:c>k;0<=k?c++:c--)if(a.keys[c]===f[c])d=!0;else{d=!1;break}d&&e.push(a)}}return e};H=function(a){var c,b,d,e,f,g,j,l,k,m;j=0;for(l=h.length;j<l;j++)if(c=h[j],
c.is_sequence){d=1;for(k=n.length;1<=k?d<=k:d>=k;1<=k?d++:d--)if(g=z(n,function(b){return 0<=i.call(c.keys,"shift")?!0:"shift"!==b}).slice(-d),c.keys.length===g.length){b=0;for(m=g.length;0<=m?b<m:b>m;0<=m?b++:b--)if(f=g[b],!(0>i.call(c.keys,"shift")&&"shift"===f)&&!("shift"===a&&0>i.call(c.keys,"shift")))if(c.keys[b]===f)e=!0;else{e=!1;break}}if(e)return c}return!1};G=function(a,c){var b;if(!c.shiftKey)return!1;b=q[a];return null!=b?b:!1};Y=function(a,c,b){if(0>i.call(a.keys,c))return!1;t(b,a&&a.prevent_default);
if(0<=i.call(g,c)&&!R(a))return!1;c=Q(a,c);a.keyup_fired=!1;a.is_counting&&"function"===typeof a.on_keydown&&(a.count+=1);if(c)return o("keydown",a,b)};ba=function(a,c){var b,d,e,f;(d=G(a,c))&&(a=d);P(a,c);(d=H(a))&&o("keydown",d,c);for(b in s)d=s[b],c[d]&&(b===a||0<=i.call(g,b)||g.push(b));for(b in s)if(d=s[b],b!==a&&0<=i.call(g,b)&&!c[d]){d=0;for(e=g.length;0<=e?d<e:d>e;0<=e?d++:d--)g[d]===b&&g.splice(d,1)}d=V(a);e=0;for(f=d.length;e<f;e++)b=d[e],Y(b,a,c);d=X(a);if(d.length){e=0;for(f=d.length;e<
f;e++)b=d[e],t(c,b.prevent_default)}0>i.call(g,a)&&g.push(a)};Z=function(a,c,b){var d,e;e=J(a);if(!a.keyup_fired&&(d=g.slice(),d.push(b),!a.is_solitary||y(d,a.keys)))o("keyup",a,c),a.is_counting&&("function"===typeof a.on_keyup&&"function"!==typeof a.on_keydown)&&(a.count+=1);e||(o("release",a,c),N(a))};I=function(a,c){var b,d,e,f,h;d=a;(e=G(a,c))&&(a=e);e=q[d];c.shiftKey?e&&0<=i.call(g,e)||(a=d):d&&0<=i.call(g,d)||(a=e);(f=H(a))&&o("keyup",f,c);if(0>i.call(g,a))return!1;f=0;for(h=g.length;0<=h?f<
h:f>h;0<=h?f++:f--)if((b=g[f])===a||b===e||b===d){g.splice(f,1);break}d=j.length;e=[];f=0;for(h=j.length;f<h;f++)b=j[f],0<=i.call(b.keys,a)&&e.push(b);f=0;for(h=e.length;f<h;f++)b=e[f],Z(b,c,a);if(1<d){d=0;for(f=j.length;d<f;d++)b=j[d],void 0===b||0<=i.call(e,b)||J(b)||N(b)}};B=function(a,c){var b;if(A)g.length&&(g=[]);else if(c||g.length)if(b=F(a.keyCode))return c?ba(b,a):I(b,a)};O=function(a){var c,b,d;d=[];c=0;for(b=h.length;0<=b?c<b:c>b;0<=b?c++:c--)if(a===h[c]){h.splice(c,1);break}else d.push(void 0);
return d};ea=function(a){var c,b,d,e,f;a.keys.length||r("You're trying to bind a combo with no keys.");b=0;for(e=a.keys.length;0<=e?b<e:b>e;0<=e?b++:b--)d=a.keys[b],(c=ca[d])&&(d=a.keys[b]=c),"meta"===d&&a.keys.splice(b,1,K),"cmd"===d&&r('Warning: use the "meta" key rather than "cmd" for Windows compatibility');f=a.keys;c=0;for(e=f.length;c<e;c++)if(d=f[c],0>i.call(E,d))return r('Do not recognize the key "'+d+'"'),!1;if(0<=i.call(a.keys,"meta")||0<=i.call(a.keys,"cmd")){c=a.keys.slice();e=0;for(f=
L.length;e<f;e++)d=L[e],-1<(b=c.indexOf(d))&&c.splice(b,1);1<c.length&&r("META and CMD key combos cannot have more than 1 non-modifier keys",a,c)}return!0};S=function(a){var c;if(0<=i.call(g,"cmd")&&"cmd"!==(c=F(a.keyCode))&&"shift"!==c&&"alt"!==c&&"caps"!==c&&"tab"!==c)return B(a,!1)};window.keypress={};keypress.force_event_defaults=!1;keypress.suppress_event_defaults=!1;keypress.sequence_delay=800;keypress.get_registered_combos=function(){return h};keypress.reset=function(){h=[]};keypress.combo=
function(a,c,b){null==b&&(b=!1);return keypress.register_combo({keys:a,on_keydown:c,prevent_default:b})};keypress.counting_combo=function(a,c,b){null==b&&(b=!1);return keypress.register_combo({keys:a,is_counting:!0,is_ordered:!0,on_keydown:c,prevent_default:b})};keypress.sequence_combo=function(a,c,b){null==b&&(b=!1);return keypress.register_combo({keys:a,on_keydown:c,is_sequence:!0,prevent_default:b})};keypress.register_combo=function(a){var c,b;"string"===typeof a.keys&&(a.keys=a.keys.split(" "));
for(c in x)fa.call(x,c)&&(b=x[c],null==a[c]&&(a[c]=b));if(ea(a))return h.push(a),!0};keypress.register_many=function(a){var c,b,d,e;e=[];b=0;for(d=a.length;b<d;b++)c=a[b],e.push(keypress.register_combo(c));return e};keypress.unregister_combo=function(a){var c,b,d;if(!a)return!1;if(a.keys)return O(a);d=[];c=0;for(b=h.length;c<b;c++)(a=h[c])&&(y(keys,a.keys)?d.push(O(a)):d.push(void 0));return d};keypress.unregister_many=function(a){var c,b,d,e;e=[];b=0;for(d=a.length;b<d;b++)c=a[b],e.push(keypress.unregister_combo(c));
return e};keypress.listen=function(){return A=!1};keypress.stop_listening=function(){return A=!0};F=function(a){return p[a]};s={cmd:"metaKey",ctrl:"ctrlKey",shift:"shiftKey",alt:"altKey"};ca={control:"ctrl",command:"cmd","break":"pause",windows:"cmd",option:"alt",caps_lock:"caps",apostrophe:"'",semicolon:";",tilde:"~",accent:"`",scroll_lock:"scroll",num_lock:"num"};q={"/":"?",".":">",",":"<","'":'"',";":":","[":"{","]":"}","\\":"|","`":"~","=":"+","-":"_",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",
8:"*",9:"(","0":")"};p={"0":"\\",8:"backspace",9:"tab",12:"num",13:"enter",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"caps",27:"escape",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",44:"print",45:"insert",46:"delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",
89:"y",90:"z",91:"cmd",92:"cmd",93:"cmd",96:"num_0",97:"num_1",98:"num_2",99:"num_3",100:"num_4",101:"num_5",102:"num_6",103:"num_7",104:"num_8",105:"num_9",106:"num_multiply",107:"num_add",108:"num_enter",109:"num_subtract",110:"num_decimal",111:"num_divide",124:"print",144:"num",145:"scroll",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",223:"`",224:"cmd",57392:"ctrl",63289:"num"};for(v in p)u=p[v],E.push(u);for(v in q)u=q[v],E.push(u);-1!==navigator.userAgent.indexOf("Mac OS X")&&
(K="cmd");-1!==navigator.userAgent.indexOf("Opera")&&(p["17"]="cmd");M=function(a){return(document.attachEvent?"complete"===document.readyState:"loading"!==document.readyState)?a():setTimeout(function(){return M(a)},9)};M(function(){var a;a=function(a,b,d){if(a.addEventListener)return a.addEventListener(b,d);if(a.attachEvent)return a.attachEvent("on"+b,d)};a(document.body,"keydown",function(a){a=a||window.event;B(a,!0);return S(a)});a(document.body,"keyup",function(a){a=a||window.event;return B(a,
!1)});return a(window,"blur",function(){var a,b,d;b=0;for(d=g.length;b<d;b++)a=g[b],I(a,{});g=[];return[]})})}).call(this);
